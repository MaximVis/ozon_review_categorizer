# ozon_review_categorizer
Cистема для автоматической категоризации текстовых отзывов с использованием предобученной языковой модели RuBERT и веб-скрапинга для сбора данных с маркетплейсов (например, Ozon)

Структура проекта:

├── main.py                    # Основной файл с логикой парсера и модели

├── rubert-model/              # Предобученная модель RuBERT

├── trained_model/             # Сохранённая дообученная модель

├── clothes_dataset.csv        # Датасет для обучения (пример)


Модель RuBERT была скачена с [huggingface.co/DeepPavlov/rubert-base-cased-conversational](https://huggingface.co/DeepPavlov/rubert-base-cased-conversational)

Датасет был сгенерирован нейросетью

Описание проекта:

В рамках решения задачи автоматической категоризации текстовых отзывов была разработана программная система, интегрирующая несколько технологических компонентов. Основной метод реализован через гибридный подход, сочетающий веб-скрапинг для сбора данных и глубокое обучение для их анализа.

Ядром системы является класс LocalMultiLabelAnalyzer, который реализует многометочную классификацию текстов на основе архитектуры трансформеров. В качестве базовой модели используется предобученный RuBERT, адаптированный для задачи классификации отзывов на товары. Модель была дообучена на сгенерированном датасете, содержащем размеченные отзывы с соответствующими категориями.

Процесс обучения организован через механизм тонкой настройки (fine-tuning) с использованием библиотеки Transformers. Для обработки многометочных данных применяется MultiLabelBinarizer, преобразующий текстовые категории в бинарные векторы. Обучение проводится с разделением данных на обучающую (60%), валидационную (20%) и тестовую (20%) выборки, что обеспечивает надежную оценку качества модели.

Для классификации текст токенизируется с помощью предобученного токенизатора RuBERT с ограничением длины последовательности до 128 токенов. Модель выдает вероятности принадлежности к каждой категории, которые затем пороговым методом преобразуются в бинарные предсказания.

Система включает механизмы оценки качества через метрики micro и macro F1-score, precision и recall.

Парсер реализован с использованием Selenium и undetected-chromedriver для обхода антибот-систем маркетплейсов. Он осуществляет навигацию по страницам товаров, динамическую подгрузку комментариев через скроллинг и извлечение текстовых данных.

Для практического использования разработан веб-интерфейс на Flask, позволяющий получать категоризацию отзывов по URL товара. Результаты возвращаются в формате JSON, где каждый отзыв связывается с предсказанными категориями.
